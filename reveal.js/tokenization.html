<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPT-2 Tokenization</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: white;
        }
        
        .token {
            display: inline-block;
            padding: 8px 12px;
            font-size: 72px;
            font-weight: 500;
            font-family: 'SF Mono', 'JetBrains Mono', 'Fira Code', 'Consolas', 'Monaco', 'Menlo', monospace;
            position: relative;
            cursor: pointer;
            border: 2px solid;
            white-space: pre;
        }
        
        .token:hover {
            opacity: 1;
        }
        
        .tooltip {
            position: absolute;
            bottom: calc(100% + 10px);
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 32px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 1000;
        }
        
        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: #333;
        }
        
        .token:hover .tooltip {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div id="tokenOutput"></div>

    <script src="https://unpkg.com/gpt-tokenizer/dist/r50k_base.js"></script>
    <script>
        // Generate consistent color for token
        function getTokenColor(tokenId) {
            const hue = (tokenId * 137.508) % 360;
            return `hsl(${hue}, 70%, 85%)`;
        }
        
        // Get border color (darker version)
        function getBorderColor(tokenId) {
            const hue = (tokenId * 137.508) % 360;
            return `hsl(${hue}, 70%, 65%)`;
        }
        
        // Get darker hover color (less transparent/more saturated)
        function getHoverColor(tokenId) {
            const hue = (tokenId * 137.508) % 360;
            return `hsl(${hue}, 70%, 75%)`; // Darker than the original 85%
        }
        
        // Get darker hover border color
        function getHoverBorderColor(tokenId) {
            const hue = (tokenId * 137.508) % 360;
            return `hsl(${hue}, 70%, 55%)`; // Darker than the original 65%
        }
        
        // Escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Initialize and display tokens
        function init() {
            const text = "Mike is quick,";
            const tokens = GPTTokenizer_r50k_base.encode(text);
            
            let html = '';
            tokens.forEach((tokenId) => {
                const tokenText = GPTTokenizer_r50k_base.decode([tokenId]);
                const backgroundColor = getTokenColor(tokenId);
                const borderColor = getBorderColor(tokenId);
                const hoverColor = getHoverColor(tokenId);
                const hoverBorderColor = getHoverBorderColor(tokenId);
                
                html += `<span class="token" style="background-color: ${backgroundColor}; border-color: ${borderColor};" onmouseenter="this.style.backgroundColor='${hoverColor}'; this.style.borderColor='${hoverBorderColor}'" onmouseleave="this.style.backgroundColor='${backgroundColor}'; this.style.borderColor='${borderColor}'">${escapeHtml(tokenText)}<div class="tooltip">ID: ${tokenId}</div></span>`;
            });
            
            document.getElementById('tokenOutput').innerHTML = html;
        }
        
        // Initialize on page load
        init();
        
        // Add keyboard navigation for reveal.js integration
        document.addEventListener('keydown', function(event) {
            if (event.key === 'ArrowRight' || event.key === ' ') {
                // Send message to parent reveal.js
                if (window.parent !== window) {
                    window.parent.postMessage('next-slide', '*');
                }
                event.preventDefault();
            } else if (event.key === 'ArrowLeft') {
                if (window.parent !== window) {
                    window.parent.postMessage('prev-slide', '*');
                }
                event.preventDefault();
            }
        });
    </script>
</body>
</html>
